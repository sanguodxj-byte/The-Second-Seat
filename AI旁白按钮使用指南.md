# ?? AI 旁白按钮使用指南

## ?? 按钮位置

### 在游戏内找到 AI 旁白按钮

#### 方法 1：通过殖民者命令栏（推荐）?

1. **进入游戏**
   ```
   开始新游戏 或 加载存档
   ```

2. **选择殖民者**
   ```
   点击任意己方殖民者
   → 屏幕底部会显示命令栏（Gizmo Bar）
   ```

3. **找到 AI 旁白按钮**
   ```
   命令栏中应该有一个按钮：
   ?? "AI 旁白" 或 "AI Narrator"
   
   位置：通常在命令栏的最右侧
   ```

4. **点击按钮**
   ```
   点击后会弹出 AI 旁白窗口
   ```

---

## ?? 如果没看到按钮

### 检查清单

#### ? 1. 模组是否已启用
```
主菜单 → 模组 → 查找 "The Second Seat"
确认：? 已勾选
如果未勾选：勾选 → 重启游戏
```

#### ? 2. 是否选择了正确的单位
```
必须选择：己方殖民者（Colonist）
不会显示按钮的单位：
  ? 囚犯
  ? 动物
  ? 敌人
  ? 访客
```

#### ? 3. 检查游戏日志
```
RimWorld 根目录\Player.log
搜索："The Second Seat" 或 "GizmoPatch"
查找错误消息
```

#### ? 4. 重新部署模组
```powershell
cd "C:\Users\Administrator\Desktop\rim mod\The Second Seat"
.\一键部署.ps1
```

---

## ?? 快速测试步骤

### 测试按钮是否正常

1. **启动 RimWorld**
2. **加载任意存档**（或新游戏）
3. **点击一个殖民者**
4. **查看底部命令栏**

**预期结果**：
```
命令栏显示：
[征召] [优先工作] [装备] ... [AI 旁白] ← 最右侧
```

---

## ?? 按钮外观

### 按钮特征
- **图标**：可能是对话气泡或麦克风图标
- **文本**：
  - 中文：`AI 旁白`
  - 英文：`AI Narrator`
- **颜色**：通常是白色或浅色背景
- **位置**：命令栏最右侧

---

## ??? 手动检查代码

### 确认按钮已编译到 DLL

```powershell
# 检查 DLL 大小
$dll = "D:\steam\steamapps\common\RimWorld\Mods\TheSecondSeat\Assemblies\TheSecondSeat.dll"
(Get-Item $dll).Length / 1KB
# 应该显示：~163 KB
```

### 检查按钮类是否存在

按钮由以下代码实现：
- **文件**：`Source\TheSecondSeat\Patches\GizmoPatch.cs`
- **类**：`Pawn_GetGizmos_Patch`
- **触发条件**：
  ```csharp
  if (__instance.Faction != Faction.OfPlayer || !__instance.IsColonist)
  {
      return; // 不显示按钮
  }
  ```

---

## ?? 常见问题

### Q: 选择了殖民者但看不到按钮
**A**: 检查：
1. 模组是否已启用？
2. 是否重启了游戏？
3. DLL 是否正确部署？

### Q: 其他模组冲突？
**A**: 可能与修改 Gizmo 的模组冲突：
- 尝试禁用其他 UI 模组
- 查看日志中的 Harmony 错误

### Q: 按钮显示但点击无反应
**A**: 检查：
1. API 是否已配置？
2. 模组设置中是否有错误？
3. 查看 Player.log

---

## ?? 界面预览

### 正常显示效果
```
┌─────────────────────────────────────────┐
│ 殖民者: John (已选中)                     │
└─────────────────────────────────────────┘

命令栏：
┌────┬────┬────┬────┬────┬────┬──────────┐
│征召│优先│装备│医疗│...  │设置│ AI 旁白  │ ← 这里！
└────┴────┴────┴────┴────┴────┴──────────┘
```

### AI 旁白窗口
点击按钮后显示：
```
┌──────────────────────────────────────┐
│ AI 叙事者助手               [X] 关闭  │
├──────────────────────────────────────┤
│                                      │
│ 好感度: ?? 75 (Devoted)     │
│                                      │
│ [输入框：在这里输入消息...]           │
│                                      │
│ [与旁白交谈] [切换人格]              │
│                                      │
└──────────────────────────────────────┘
```

---

## ?? 紧急修复

### 如果完全找不到按钮

#### 方案 1：重新编译和部署
```powershell
cd "C:\Users\Administrator\Desktop\rim mod\The Second Seat\Source\TheSecondSeat"
dotnet build -c Release
cd ..\..
.\一键部署.ps1
```

#### 方案 2：手动添加按钮热键
如果按钮不显示，可以添加热键快捷方式（需要修改代码）

#### 方案 3：检查 Harmony 补丁
```csharp
// 验证补丁是否应用
// 查看 Player.log 中的：
// [Harmony] Patching TheSecondSeat.Patches.Pawn_GetGizmos_Patch
```

---

## ?? 需要帮助？

### 提供以下信息
1. **RimWorld 版本**
2. **模组版本**
3. **Player.log**（最后 50 行）
4. **截图**（命令栏）

---

## ? 成功标志

如果你看到了：
- ? 命令栏中有 "AI 旁白" 按钮
- ? 点击后弹出窗口
- ? 窗口显示好感度和输入框

**恭喜！按钮工作正常！** ??

---

## ?? 快速开始对话

1. 点击 AI 旁白按钮
2. 在输入框输入：`你好`
3. 点击"与旁白交谈"
4. 等待 AI 回复

**预期回复示例**：
```
"你好！我是你的 AI 叙事者。
当前殖民地状况良好，有什么需要我帮助的吗？"
```

---

**创建时间**：2025-01-XX  
**适用版本**：The Second Seat v1.0+

**记住**：按钮在殖民者命令栏的最右侧！??

# ?? v1.6.65 新功能快速参考

## 1?? TTS 语音打断（最优先）

**修改文件**: `Source/TheSecondSeat/TTS/TTSAudioPlayer.cs`

**关键代码**:
```csharp
private AudioSource currentAudioSource;
private Coroutine currentPlaybackCoroutine;

public void PlayAudioWithInterrupt(AudioClip clip)
{
    // 停止旧语音
    if (currentAudioSource?.isPlaying == true)
    {
        currentAudioSource.Stop();
    }
    
    // 停止嘴部动画
    if (currentPlaybackCoroutine != null)
    {
        StopCoroutine(currentPlaybackCoroutine);
    }
    
    // 播放新语音
    audioSource.clip = clip;
    audioSource.Play();
    currentAudioSource = audioSource;
    currentPlaybackCoroutine = StartCoroutine(PlayWithMouthAnimation(clip));
}
```

---

## 2?? 口型动画速度优化

**修改文件**: `Source/TheSecondSeat/PersonaGeneration/MouthAnimationSystem.cs`

**参数调整**:
```csharp
// v1.6.65: 更慢、更平滑
private const float OPEN_SPEED = 0.8f;      // ↓ from 1.5
private const float CLOSE_SPEED = 1.2f;     // ↓ from 2.0
private const float HOLD_DURATION = 0.15f;  // ↑ from 0.1
private const float SMOOTH_FACTOR = 0.08f;  // ↓ from 0.15
```

---

## 3?? RimAgent 思考链（后续）

**新建目录**: `Source/TheSecondSeat/RimAgent/`

**核心文件**:
- `RimAgent.cs` - 主逻辑
- `RimAgentTools.cs` - 工具库
- `RimAgentPrompts.cs` - Prompt 模板

---

**立即开始**: 先实现 1 和 2

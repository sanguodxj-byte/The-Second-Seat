# ========================================
# 自动部署快速启动指南
# ========================================

## ?? 启动自动部署

### 方式1：标准启动
```powershell
.\Auto-Deploy.ps1
```

### 方式2：自定义参数
```powershell
# 监控特定路径
.\Auto-Deploy.ps1 -WatchPath "Source\TheSecondSeat\UI"

# 调整防抖延迟（默认3秒）
.\Auto-Deploy.ps1 -DebounceSeconds 5
```

---

## ?? 工作流程

```
文件变化
  ↓
等待3秒（防抖）
  ↓
自动编译
  ↓
自动部署到RimWorld
  ↓
提示音（成功：高音/失败：低音）
```

---

## ?? 使用场景

### 开发时
1. **启动脚本**：`.\Auto-Deploy.ps1`
2. **编辑代码**：在VS Code或Visual Studio中修改.cs文件
3. **保存文件**：Ctrl+S
4. **自动部署**：脚本检测到变化，自动编译并部署
5. **测试游戏**：刷新RimWorld，查看效果

### 优势
- ? **无需手动编译** - 保存即部署
- ? **防抖机制** - 连续保存多个文件只触发一次部署
- ? **声音提示** - 成功/失败有不同提示音
- ? **实时反馈** - 控制台显示部署状态

---

## ?? 配置说明

### 监控路径
默认监控：`Source\TheSecondSeat`（整个项目）

可自定义：
```powershell
# 只监控UI相关文件
.\Auto-Deploy.ps1 -WatchPath "Source\TheSecondSeat\UI"

# 监控特定模块
.\Auto-Deploy.ps1 -WatchPath "Source\TheSecondSeat\PersonaGeneration"
```

### 防抖延迟
默认：3秒

场景：
```powershell
# 快速开发（减少等待）
.\Auto-Deploy.ps1 -DebounceSeconds 1

# 稳定开发（避免频繁编译）
.\Auto-Deploy.ps1 -DebounceSeconds 5
```

---

## ?? 控制台输出示例

```
[14:23:45] ========================================
[14:23:45]   自动部署监控已启动
[14:23:45] ========================================
[14:23:45] 监控路径: Source\TheSecondSeat
[14:23:45] 防抖延迟: 3 秒
[14:23:45] 按 Ctrl+C 停止监控
[14:23:45] 
[14:23:45] 执行初始部署...
[14:23:45] === 检测到文件变化，开始部署 ===
...
[14:23:50] ? 部署成功！
[14:23:50] 
[14:23:50] 监控已就绪，等待文件变化...

[14:25:12] 检测到变化: Source\TheSecondSeat\UI\NarratorWindow.cs
[14:25:15] === 检测到文件变化，开始部署 ===
...
[14:25:20] ? 部署成功！
```

---

## ?? 注意事项

### 1. 内存占用
长时间运行可能占用内存，建议定期重启。

### 2. 编译失败
如果编译失败，会发出低音提示，检查错误日志。

### 3. 停止监控
按 `Ctrl+C` 停止监控，脚本会自动清理资源。

### 4. 文件锁定
如果RimWorld正在运行，可能无法覆盖DLL文件，需要关闭游戏。

---

## ?? 最佳实践

### 推荐工作流

1. **启动监控**
   ```powershell
   .\Auto-Deploy.ps1
   ```

2. **关闭RimWorld**（首次部署）
   - 确保DLL文件可以被覆盖

3. **编辑代码**
   - 使用VS Code或Visual Studio
   - 保存文件触发自动部署

4. **启动RimWorld测试**
   - 首次启动后，可以保持游戏运行
   - 每次代码变化后，退出到主菜单再重新加载存档

5. **循环开发**
   - 编辑 → 保存 → 自动部署 → 测试 → 编辑

---

## ?? 提示音说明

- **成功部署**：800Hz 短促提示音
- **部署失败**：400Hz 较长提示音

---

## ??? 故障排除

### 问题1：监控无反应
**解决**：检查监控路径是否正确
```powershell
Get-ChildItem "Source\TheSecondSeat" -Recurse -Filter "*.cs"
```

### 问题2：频繁触发
**解决**：增加防抖延迟
```powershell
.\Auto-Deploy.ps1 -DebounceSeconds 5
```

### 问题3：部署失败
**解决**：
1. 检查编译错误
2. 确认RimWorld已关闭
3. 手动运行 `.\Smart-Deploy.ps1` 查看详细错误

---

## ?? 与其他脚本对比

| 脚本 | 用途 | 触发方式 |
|------|------|----------|
| `Smart-Deploy.ps1` | 单次部署 | 手动运行 |
| `Auto-Deploy.ps1` | 自动部署 | 文件变化自动触发 |
| `Quick-Deploy.ps1` | 快速部署 | 手动运行（跳过检查） |

---

**创建时间**: 2025-01-15  
**版本**: v1.0  
**状态**: ? 可用

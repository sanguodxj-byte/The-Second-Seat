# 分层立绘路径修复说明 - v1.6.18

## ? **问题已修复！**

### ?? **发现的问题**

发现了**两个分层立绘文件夹**：
1. ? `Textures\UI\Narrators\9x16\Layers\` - **错误的（旧）**
2. ? `Textures\UI\Narrators\9x16\Layered\` - **正确的（新）**

**矛盾：**
- 代码 (`LayerDefinition.cs`) 使用的是 `Layers/`
- README 文档和文件夹结构使用的是 `Layered/`

---

## ?? **已完成的修复**

### **代码修复（已提交）**

修改了 `Source/TheSecondSeat/PersonaGeneration/LayerDefinition.cs` 中的所有路径：

**修改前：**
```csharp
TexturePath = "UI/Narrators/9x16/Layers/{persona}/background.png"
TexturePath = "UI/Narrators/9x16/Layers/{persona}/body.png"
TexturePath = "UI/Narrators/9x16/Layers/{persona}/outfit_{outfit}.png"
```

**修改后：**
```csharp
TexturePath = "UI/Narrators/9x16/Layered/{persona}/background.png"
TexturePath = "UI/Narrators/9x16/Layered/{persona}/body.png"
TexturePath = "UI/Narrators/9x16/Layered/{persona}/outfit_{outfit}.png"
```

---

## ?? **文件夹结构（正确）**

```
Textures/UI/Narrators/9x16/
├── Cassandra/               ← 完整立绘
├── Sideria/                 ← 完整立绘
├── Expressions/             ← 表情文件夹
│   ├── Sideria/
│   │   ├── neutral.png
│   │   ├── happy.png
│   │   └── ...
│   └── README.md
└── Layered/                 ← ? 分层立绘文件夹（正确）
    ├── Sideria/
    │   ├── background.png
    │   ├── body.png
    │   ├── outfit_default.png
    │   ├── face_neutral.png
    │   ├── face_happy.png
    │   ├── hair.png
    │   ├── accessories.png
    │   ├── eyes_open.png
    │   ├── eyes_half.png
    │   ├── eyes_closed.png
    │   ├── mouth_closed.png
    │   ├── mouth_smile.png
    │   ├── mouth_open_small.png
    │   └── mouth_open_wide.png
    └── README.md
```

---

## ?? **需要手动操作**

### **删除错误的 `Layers/` 文件夹**

由于文件被占用（可能被 Visual Studio 或资源管理器打开），无法自动删除。

**手动删除步骤：**
1. 关闭 Visual Studio
2. 关闭所有资源管理器窗口
3. 手动删除文件夹：
   ```
   Textures\UI\Narrators\9x16\Layers\
   ```
4. 确认只保留 `Layered/` 文件夹

---

## ?? **正确使用方法**

### **放置纹理文件**

**分层立绘纹理应放在：**
```
Textures/UI/Narrators/9x16/Layered/{PersonaName}/
```

**示例（Sideria 人格）：**
```
Textures/UI/Narrators/9x16/Layered/Sideria/
├── background.png        ← 背景层
├── body.png              ← 身体层
├── outfit_default.png    ← 默认服装
├── face_neutral.png      ← 默认表情
├── face_happy.png        ← 开心表情
├── hair.png              ← 头发层
├── accessories.png       ← 配饰层
├── eyes_open.png         ← 睁眼层（眨眼动画）
├── eyes_half.png         ← 半闭眼层（眨眼动画）
├── eyes_closed.png       ← 闭眼层（眨眼动画）
├── mouth_closed.png      ← 闭嘴层（张嘴动画）
├── mouth_smile.png       ← 微笑层（张嘴动画）
├── mouth_open_small.png  ← 小张嘴层（张嘴动画）
└── mouth_open_wide.png   ← 大张嘴层（张嘴动画）
```

---

## ?? **相关文档**

- [Layered/README.md](Textures/UI/Narrators/9x16/Layered/README.md) - 分层立绘详细说明
- [眨眼和张嘴动画-纹理资源模板-v1.6.18.md](眨眼和张嘴动画-纹理资源模板-v1.6.18.md)
- [分层立绘系统-快速参考.md](分层立绘系统-快速参考.md)

---

## ?? **验证修复**

### **检查代码**
```bash
# 搜索代码中是否还有 Layers/ 路径
Select-String -Path "Source\TheSecondSeat\**\*.cs" -Pattern "Layers/" -CaseSensitive
```

**期望结果：** 无输出（所有 `Layers/` 已改为 `Layered/`）

### **检查文件夹**
```bash
# 查看 9x16 文件夹下的子目录
Get-ChildItem -Path "Textures\UI\Narrators\9x16" -Directory | Select-Object Name
```

**期望结果：**
```
Name       
----       
Cassandra  
Expressions
Layered     ← ? 只应该有这个
Sideria    
```

---

## ?? **修复完成**

### **已完成：**
- ? 修改代码中所有路径：`Layers/` → `Layered/`
- ? 提交并推送到 GitHub (Commit: 3236576)

### **待完成（手动）：**
- ? 删除错误的 `Textures\UI\Narrators\9x16\Layers\` 文件夹

### **统一规范：**
- ? 代码使用：`UI/Narrators/9x16/Layered/`
- ? 文档使用：`Layered/`
- ? 文件夹名称：`Layered/`

---

**版本：** v1.6.18-layered-path-fix  
**状态：** ? 代码已修复，已推送  
**Commit:** 3236576  
**剩余工作：** 手动删除 `Layers/` 文件夹

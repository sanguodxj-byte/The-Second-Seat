# 分层立绘纹理资源说明 - Layered Folder

## ?? 文件夹用途

此文件夹用于存放 AI 人格的**分层立绘纹理**。支持眨眼动画、张嘴动画、换装系统等高级功能。

---

## ?? 文件结构

```
Textures/UI/Narrators/9x16/Layered/
├── Sideria/                          ← 人格文件夹（每个人格一个）
│   ├── base_body.png                 ← 身体层（必需）
│   ├── face_neutral.png              ← 默认表情（必需）
│   ├── face_happy.png                ← 开心表情
│   ├── face_sad.png                  ← 悲伤表情
│   ├── outfit_default.png            ← 默认服装（可选）
│   │
│   ├── eyes_open.png                 ← ? 睁眼层（眨眼动画）
│   ├── eyes_half.png                 ← ? 半闭眼层（眨眼动画）
│   ├── eyes_closed.png               ← ? 闭眼层（眨眼动画）
│   │
│   ├── mouth_closed.png              ← ? 闭嘴层（张嘴动画）
│   ├── mouth_smile.png               ← ? 微笑层（张嘴动画）
│   ├── mouth_open_small.png          ← ? 小张嘴层（张嘴动画）
│   ├── mouth_open_wide.png           ← ? 大张嘴层（张嘴动画）
│   ├── mouth_frown.png               ← ? 皱眉层（可选）
│   │
│   ├── hair.png                      ← 头发层（可选）
│   ├── accessories.png               ← 配饰层（可选）
│   └── background.png                ← 背景层（可选）
│
└── README.md                         ← 本文件
```

---

## ?? 纹理规格要求

### **统一尺寸标准**
- **尺寸：** 1024×1574 像素（9:16 比例）
- **格式：** PNG（支持透明通道）
- **背景：** 完全透明（除背景层外）
- **分辨率：** 300 DPI（推荐）

### **质量要求**
- **颜色模式：** RGBA（32位）
- **压缩：** PNG-24（保留完整透明度）
- **文件大小：** 建议 < 2MB

---

## ?? 命名规范

### **必需文件（每个人格）**
```
base_body.png           ← 身体层（全身轮廓）
face_neutral.png        ← 默认表情（面部）
```

### **表情层（可选）**
```
face_{expression}.png   ← 表情专用层
```
**示例：**
- `face_happy.png` - 开心表情
- `face_sad.png` - 悲伤表情
- `face_angry.png` - 生气表情

### **眨眼动画层（推荐）**
```
eyes_open.png           ← 睁眼层（默认）
eyes_half.png           ← 半闭眼层（过渡帧）
eyes_closed.png         ← 闭眼层（眨眼中间帧）
```

### **张嘴动画层（推荐）**
```
mouth_closed.png        ← 闭嘴层（默认）
mouth_smile.png         ← 微笑层（Happy表情）
mouth_open_small.png    ← 小张嘴层（说话轻声）
mouth_open_wide.png     ← 大张嘴层（说话强调/惊讶）
mouth_frown.png         ← 皱眉层（Sad/Angry表情，可选）
```

### **服装层（可选）**
```
outfit_{name}.png       ← 服装层（可更换）
```
**示例：**
- `outfit_default.png` - 默认服装
- `outfit_casual.png` - 休闲服装
- `outfit_formal.png` - 正式服装

### **其他层（可选）**
```
hair.png                ← 头发层
accessories.png         ← 配饰层（眼镜、帽子等）
background.png          ← 背景层（光晕、特效等）
```

---

## ?? 图层优先级

系统按以下顺序合成图层（从底到顶）：

```
1. background.png       (优先级 0)
2. base_body.png        (优先级 10)
3. outfit_*.png         (优先级 20)
4. face_*.png           (优先级 30)
5. eyes_*.png           (优先级 35) ← ? 眨眼动画
6. mouth_*.png          (优先级 36) ← ? 张嘴动画
7. hair.png             (优先级 40)
8. accessories.png      (优先级 50)
```

---

## ??? 图层制作指南

### **1. 身体层（base_body.png）**
**内容：** 完整的人物轮廓（不包含面部细节）

**制作要点：**
- 包含身体、四肢、基础轮廓
- 不包含面部表情
- 可包含身体基础阴影

**示例：**
```
? 正确：身体轮廓 + 基础阴影
? 错误：包含完整面部表情
```

---

### **2. 表情层（face_*.png）**
**内容：** 面部表情区域（眼睛、鼻子、嘴巴）

**制作要点：**
- **尺寸：** 1024×1574（与身体层相同）
- **内容：** 只包含面部表情区域
- **透明区域：** 除面部外的所有区域
- **对齐：** 必须与 `base_body.png` 像素级对齐

**关键原则：**
> **所有表情层的面部位置必须完全一致！**

**检查方法：**
1. 在 Photoshop 中叠加多个表情层
2. 切换图层可见性
3. 确认眼睛、鼻子、嘴巴位置不偏移

---

### **3. 眨眼动画层（eyes_*.png）**
**内容：** 只包含眼睛部分

**制作要点：**
- **尺寸：** 1024×1574（保持一致）
- **内容：** 只包含眼睛（睫毛、眼睑）
- **透明区域：** 除眼睛外的所有区域
- **对齐：** 与 `face_neutral.png` 中的眼睛位置完全对齐

**制作步骤：**
```
1. 从 face_neutral.png 复制眼睛区域
2. 删除其他面部元素
3. 创建三个变体：
   - eyes_open.png    ← 完全睁开
   - eyes_half.png    ← 半闭（上眼睑下垂 40%）
   - eyes_closed.png  ← 完全闭合
```

**参考尺寸：**
- 单眼宽度：约 80-120 像素
- 单眼高度：约 40-60 像素
- 双眼间距：约 150-200 像素
- 垂直位置：距顶部约 380-450 像素

---

### **4. 张嘴动画层（mouth_*.png）**
**内容：** 只包含嘴巴部分

**制作要点：**
- **尺寸：** 1024×1574（保持一致）
- **内容：** 只包含嘴巴（唇部、舌头、牙齿）
- **透明区域：** 除嘴巴外的所有区域
- **对齐：** 与 `face_neutral.png` 中的嘴巴位置完全对齐

**制作步骤：**
```
1. 从 face_neutral.png 复制嘴巴区域
2. 删除其他面部元素
3. 创建四个变体：
   - mouth_closed.png      ← 闭嘴（默认）
   - mouth_smile.png       ← 微笑（嘴角上扬）
   - mouth_open_small.png  ← 小张嘴（开口 5-8px）
   - mouth_open_wide.png   ← 大张嘴（开口 15-20px）
```

**参考尺寸：**
- 嘴巴宽度：约 100-150 像素
- 嘴巴高度：约 30-50 像素（闭合）
- 嘴巴高度：约 50-80 像素（大张）
- 垂直位置：距顶部约 650-750 像素

---

### **5. 服装层（outfit_*.png）**
**内容：** 服装、配饰（不包含身体）

**制作要点：**
- 只包含服装部分
- 与 `base_body.png` 对齐
- 支持多套服装（换装系统）

---

## ?? 图层对齐技巧

### **Photoshop 对齐方法**
1. 打开 `base_body.png` 作为底层
2. 导入其他层（File → Place Embedded）
3. 使用标尺（Ctrl+R）设置参考线
4. 锁定图层位置（Lock Position）
5. 导出前再次检查对齐

### **GIMP 对齐方法**
1. 打开 `base_body.png` 作为底层
2. 添加其他层（Layer → Open as Layers）
3. 使用对齐工具（Shift+Q）
4. 开启"吸附到参考线"
5. 导出前检查对齐

---

## ?? 导出设置

### **Photoshop 导出**
```
文件 → 导出 → 导出为...
- 格式：PNG
- 透明度：勾选
- 尺寸：1024×1574
- 质量：100%
- 元数据：最少
```

### **GIMP 导出**
```
文件 → 导出为...
- 格式：PNG
- 压缩级别：9
- 保存背景色：取消勾选
- 保存 Gamma：取消勾选
```

---

## ?? 动画效果预览

### **眨眼动画**
```
eyes_open → eyes_half → eyes_closed → eyes_half → eyes_open
   (睁眼)     (半闭)       (闭眼)       (半闭)     (睁眼)
   0.05秒     0.05秒      0.05秒      0.05秒     停留3-6秒
```

### **张嘴动画（TTS 播放时）**
```
说话轻声：mouth_closed ? mouth_open_small
说话强调：mouth_closed ? mouth_open_wide
表情微笑：mouth_smile（静态）
表情皱眉：mouth_frown（静态）
```

---

## ? 质量检查清单

### **文件命名**
- [ ] 全小写字母
- [ ] 无空格、无特殊字符
- [ ] PNG 格式后缀

### **纹理质量**
- [ ] 尺寸精确 1024×1574
- [ ] 透明背景（除背景层）
- [ ] 无白边/黑边/毛边
- [ ] 颜色与基础立绘一致

### **图层对齐**
- [ ] 所有表情层面部位置一致
- [ ] 眼睛层与 face_neutral.png 对齐
- [ ] 嘴巴层与 face_neutral.png 对齐
- [ ] 服装层与 base_body.png 对齐

### **动画测试**
- [ ] 眨眼序列流畅（open → half → closed）
- [ ] 张嘴过渡自然（closed → small → wide）
- [ ] 表情切换无跳变
- [ ] 与呼吸动画配合正常

---

## ?? 常见问题

### **Q1: 图层错位？**
**A:** 
1. 检查所有层尺寸是否一致（1024×1574）
2. 使用图像编辑软件的对齐工具
3. 参考 [眨眼和张嘴动画-纹理资源模板-v1.6.18.md](../../../眨眼和张嘴动画-纹理资源模板-v1.6.18.md)

### **Q2: 眨眼动画不流畅？**
**A:** 
1. 确认三个眨眼层都存在（open/half/closed）
2. 检查眼睛位置是否对齐
3. 查看 DevMode 日志确认加载

### **Q3: 张嘴动画不生效？**
**A:** 
1. 确认 TTS 正在播放
2. 检查嘴巴层是否存在（mouth_*.png）
3. 确认嘴巴位置与 face_neutral.png 对齐

### **Q4: 文件太大？**
**A:** 
1. 使用 PNG 优化工具压缩
2. 减少不必要的图层
3. 合并静态图层

---

## ?? 相关文档

- [眨眼和张嘴动画-纹理资源模板-v1.6.18.md](../../../眨眼和张嘴动画-纹理资源模板-v1.6.18.md)
- [分层立绘系统-快速参考.md](../../../分层立绘系统-快速参考.md)
- [呼吸动画与分层立绘-快速参考-v1.6.18.md](../../../呼吸动画与分层立绘-快速参考-v1.6.18.md)

---

## ?? 技术支持

- **GitHub Issues:** https://github.com/sanguodxj-byte/The-Second-Seat/issues
- **Wiki:** https://github.com/sanguodxj-byte/The-Second-Seat/wiki

---

**更新日期：** 2025-01-XX  
**版本：** v1.6.18  
**维护者：** The Second Seat 开发团队

# 表情纹理资源说明 - Expressions Folder

## ?? 文件夹用途

此文件夹用于存放 AI 人格的动态表情纹理文件。支持**分层立绘系统**，可以单独替换表情层，实现丰富的动画效果。

---

## ?? 文件结构

```
Textures/UI/Narrators/9x16/Expressions/
├── Sideria/                          ← 人格文件夹（每个人格一个）
│   ├── neutral.png                   ← 默认表情（必需）
│   ├── happy.png                     ← 开心表情
│   ├── happy1.png                    ← 开心表情变体1（可选）
│   ├── happy2.png                    ← 开心表情变体2（可选）
│   ├── sad.png                       ← 悲伤表情
│   ├── angry.png                     ← 生气表情
│   ├── surprised.png                 ← 惊讶表情
│   ├── confused.png                  ← 疑惑表情
│   ├── smug.png                      ← 得意表情
│   ├── shy.png                       ← 害羞表情
│   ├── bored.png                     ← 无聊表情（可选）
│   ├── excited.png                   ← 兴奋表情（可选）
│   ├── worried.png                   ← 担心表情（可选）
│   ├── determined.png                ← 坚定表情（可选）
│   └── playful.png                   ← 顽皮表情（可选）
│
└── README.md                         ← 本文件
```

---

## ?? 纹理规格要求

### **尺寸标准**
- **推荐尺寸：** 1024×1574 像素（9:16 比例）
- **格式：** PNG（支持透明通道）
- **背景：** 完全透明（RGB: 0, 0, 0, A: 0）

### **质量要求**
- **分辨率：** 300 DPI（推荐）
- **颜色模式：** RGBA（32位）
- **压缩：** PNG-8 或 PNG-24
- **文件大小：** 建议 < 2MB

---

## ?? 命名规范

### **1. 基础命名格式**
```
{expression}.png
```

**示例：**
- `neutral.png` - 默认表情
- `happy.png` - 开心表情
- `sad.png` - 悲伤表情

### **2. 变体命名格式**
支持每种表情最多 5 个变体，系统会随机选择：
```
{expression}{variant_number}.png
```

**示例：**
- `happy1.png` - 开心表情变体1
- `happy2.png` - 开心表情变体2
- `happy3.png` - 开心表情变体3

### **3. 命名规则**
- ? **全小写** - 使用小写字母（`happy`，不是 `Happy`）
- ? **无空格** - 使用下划线连接（`very_happy`，不是 `very happy`）
- ? **无特殊字符** - 只允许字母、数字、下划线
- ? **PNG 扩展名** - 必须是 `.png` 后缀

---

## ?? 支持的表情类型

| 表情类型 | 文件名 | 必需 | 说明 |
|---------|--------|------|------|
| 默认 | `neutral.png` | ? 是 | 平静/中性表情 |
| 开心 | `happy.png` | ? 推荐 | 微笑/愉快 |
| 悲伤 | `sad.png` | ? 推荐 | 失落/难过 |
| 生气 | `angry.png` | ? 推荐 | 愤怒/不满 |
| 惊讶 | `surprised.png` | ? 推荐 | 吃惊/意外 |
| 疑惑 | `confused.png` | ? 推荐 | 困惑/不解 |
| 得意 | `smug.png` | ? 推荐 | 自信/满意 |
| 害羞 | `shy.png` | ? 推荐 | 害羞/腼腆 |
| 无聊 | `bored.png` | ? 可选 | 厌烦/无趣 |
| 兴奋 | `excited.png` | ? 可选 | 激动/热情 |
| 担心 | `worried.png` | ? 可选 | 焦虑/不安 |
| 坚定 | `determined.png` | ? 可选 | 认真/决心 |
| 顽皮 | `playful.png` | ? 可选 | 调皮/俏皮 |

---

## ??? 表情制作指南

### **方法 1：完整立绘（推荐新手）**
直接替换整个立绘纹理，包含表情：
```
happy.png = 完整的开心状态立绘（1024×1574）
```

**优点：**
- 简单直接，容易上手
- 无需考虑图层对齐

**缺点：**
- 文件体积较大
- 服装/配饰无法复用

### **方法 2：分层立绘（推荐进阶）**
只包含表情部分，系统自动合成：
```
happy.png = 只包含面部表情（1024×1574，透明背景）
```

**配合使用：**
- `Layered/{Persona}/base_body.png` - 身体层
- `Layered/{Persona}/face_neutral.png` - 默认面部
- `Expressions/{Persona}/happy.png` - 开心表情（只有面部）

**优点：**
- 文件体积小
- 可复用身体/服装层
- 支持动态换装

**缺点：**
- 需要精确对齐
- 制作稍复杂

---

## ?? 制作工具推荐

### **图像编辑软件**
1. **Photoshop** - 专业首选（付费）
2. **GIMP** - 免费开源替代
3. **Krita** - 专业绘画工具（免费）
4. **Clip Studio Paint** - 漫画/插画专用（付费）

### **AI 辅助工具**
1. **Stable Diffusion** - 生成基础立绘
2. **ControlNet** - 精确控制表情
3. **Segment Anything** - 自动分离图层

---

## ?? 导出设置

### **Photoshop 导出**
```
文件 → 导出 → 导出为...
- 格式：PNG
- 透明度：勾选
- 尺寸：1024×1574
- 质量：100%
```

### **GIMP 导出**
```
文件 → 导出为...
- 格式：PNG
- 压缩级别：9
- 保存背景色：取消勾选
```

---

## ?? 回退机制

如果表情文件缺失，系统会自动回退：

1. **变体回退** - `happy3.png` 缺失 → 尝试 `happy.png`
2. **默认回退** - `happy.png` 缺失 → 使用 `neutral.png`
3. **占位符回退** - `neutral.png` 也缺失 → 显示纯色占位符

---

## ?? 测试清单

### **文件验证**
- [ ] 文件命名全小写
- [ ] PNG 格式，透明背景
- [ ] 尺寸 1024×1574
- [ ] 文件大小 < 2MB

### **游戏内测试**
- [ ] 启动 RimWorld
- [ ] 启用 DevMode（Ctrl+F12）
- [ ] 查看日志确认表情加载
- [ ] 触发表情切换测试
- [ ] 检查表情显示是否正确

---

## ?? 常见问题

### **Q1: 表情不显示？**
**A:** 检查文件命名是否正确（全小写，无空格），确认路径：
```
Textures/UI/Narrators/9x16/Expressions/{PersonaName}/{expression}.png
```

### **Q2: 表情错位？**
**A:** 确认尺寸精确为 1024×1574，使用图像编辑软件检查画布大小。

### **Q3: 表情切换不流畅？**
**A:** 检查文件大小，建议压缩到 < 2MB，使用 PNG 优化工具。

### **Q4: 变体不生效？**
**A:** 确认变体命名正确（如 `happy1.png`），且至少有一个基础文件（`happy.png`）。

---

## ?? 相关文档

- [分层立绘系统-快速参考.md](../../../分层立绘系统-快速参考.md)
- [表情系统实现总结.md](../../../表情系统实现总结.md)
- [呼吸动画与分层立绘-快速参考-v1.6.18.md](../../../呼吸动画与分层立绘-快速参考-v1.6.18.md)

---

## ?? 技术支持

- **GitHub Issues:** https://github.com/sanguodxj-byte/The-Second-Seat/issues
- **Wiki:** https://github.com/sanguodxj-byte/The-Second-Seat/wiki

---

**更新日期：** 2025-01-XX  
**版本：** v1.6.18  
**维护者：** The Second Seat 开发团队

<?xml version="1.0" encoding="utf-8" ?>
<Defs>

  <!-- ============================================== -->
  <!-- 血棘龙技能：猩红狂怒 -->
  <!-- 每次近战攻击减少冷却时间，可叠加 -->
  <!-- ============================================== -->
  <HediffDef>
    <defName>Sideria_BloodThorn_CrimsonRage</defName>
    <label>crimson rage</label>
    <description>The blood thorn dragon's primal rage grows with each strike. Every melee attack reduces the cooldown of the next attack. Stacks up to 10 times.</description>
    <hediffClass>HediffWithComps</hediffClass>
    <defaultLabelColor>(0.8, 0.2, 0.2)</defaultLabelColor>
    <isBad>false</isBad>
    <initialSeverity>1.0</initialSeverity>
    <maxSeverity>1.0</maxSeverity>
    <stages>
      <li>
        <label>enraged</label>
        <statOffsets>
          <MeleeHitChance>0.1</MeleeHitChance>
        </statOffsets>
      </li>
    </stages>
    <comps>
      <li Class="TheSecondSeat.HediffCompProperties_BloodThornRage">
        <maxStacks>10</maxStacks>
        <cooldownReductionPerStack>0.05</cooldownReductionPerStack> <!-- 5% per stack -->
        <stackDuration>600</stackDuration> <!-- 10 seconds -->
      </li>
    </comps>
  </HediffDef>

  <!-- 狂怒层数 Buff (隐藏) -->
  <HediffDef>
    <defName>TSS_BloodThorn_RageStack</defName>
    <label>crimson rage stack</label>
    <description>Accumulated rage increasing attack speed.</description>
    <hediffClass>HediffWithComps</hediffClass>
    <defaultLabelColor>(0.8, 0.2, 0.2)</defaultLabelColor>
    <isBad>false</isBad>
    <maxSeverity>10.0</maxSeverity>
    <stages>
      <li>
        <minSeverity>0</minSeverity>
        <label>1 stack</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.95</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>2</minSeverity>
        <label>2 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.90</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>3</minSeverity>
        <label>3 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.85</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>4</minSeverity>
        <label>4 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.80</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>5</minSeverity>
        <label>5 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.75</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>6</minSeverity>
        <label>6 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.70</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>7</minSeverity>
        <label>7 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.65</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>8</minSeverity>
        <label>8 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.60</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>9</minSeverity>
        <label>9 stacks</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.55</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
      <li>
        <minSeverity>10</minSeverity>
        <label>max rage</label>
        <statFactors>
          <MeleeWeapon_CooldownMultiplier>0.50</MeleeWeapon_CooldownMultiplier>
        </statFactors>
      </li>
    </stages>
    <comps>
      <li Class="HediffCompProperties_SeverityPerDay">
        <severityPerDay>-50</severityPerDay> <!-- Fast decay -->
      </li>
    </comps>
  </HediffDef>

  <!-- ============================================== -->
  <!-- 煌耀龙技能：神圣重生 -->
  <!-- 生命值过低时触发 -> 消失 -> 回血 -> 重生 -> 爆炸 -->
  <!-- ============================================== -->
  <HediffDef>
    <defName>Sideria_Radiant_SacredRebirth</defName>
    <label>sacred rebirth</label>
    <description>The radiant dragon is protected by sacred energy. When its health drops below 30%, it vanishes into pure light, regenerating its wounds, and reappears nearby with a devastating explosion of holy fire. This effect has a long cooldown.</description>
    <hediffClass>HediffWithComps</hediffClass>
    <defaultLabelColor>(1.0, 0.8, 0.2)</defaultLabelColor>
    <isBad>false</isBad>
    <initialSeverity>1.0</initialSeverity>
    <maxSeverity>1.0</maxSeverity>
    <comps>
      <li Class="TheSecondSeat.HediffCompProperties_RadiantRebirth">
        <cooldownTicks>60000</cooldownTicks> <!-- 1 day cooldown -->
        <triggerHealthPct>0.3</triggerHealthPct>
        <healPct>0.5</healPct>
        <vanishDuration>120</vanishDuration> <!-- 2 seconds vanished -->
        <explosionRadius>5.9</explosionRadius>
        <explosionDamage>50</explosionDamage>
      </li>
    </comps>
  </HediffDef>

  <!-- 煌耀龙隐藏点 -->
  <ThingDef>
    <defName>TSS_DragonHidingSpot</defName>
    <label>sacred light</label>
    <thingClass>TheSecondSeat.DragonHidingSpot</thingClass>
    <category>Mote</category>
    <tickerType>Normal</tickerType>
    <altitudeLayer>MoteOverhead</altitudeLayer>
    <useHitPoints>false</useHitPoints>
    <isSaveable>true</isSaveable>
    <graphicData>
      <texPath>Things/Mote/BrightFlash</texPath>
      <graphicClass>Graphic_Mote</graphicClass>
      <shaderType>MoteGlow</shaderType>
      <drawSize>2.0</drawSize>
    </graphicData>
  </ThingDef>

  <!-- ============================================== -->
  <!-- 机铠龙技能：全弹发射 -->
  <!-- 16发全弹发射 -->
  <!-- ============================================== -->
  <HediffDef>
    <defName>Sideria_Mecha_OmniFire</defName>
    <label>omni-fire system</label>
    <description>The mecha dragon's automated weapon systems periodically lock onto enemies and unleash a devastating barrage of 16 charge blaster shots.</description>
    <hediffClass>HediffWithComps</hediffClass>
    <defaultLabelColor>(0.2, 0.8, 1.0)</defaultLabelColor>
    <isBad>false</isBad>
    <initialSeverity>1.0</initialSeverity>
    <maxSeverity>1.0</maxSeverity>
    <comps>
      <li Class="TheSecondSeat.HediffCompProperties_MechaOmniFire">
        <fireIntervalRange>400~800</fireIntervalRange> <!-- Slightly longer interval -->
        <burstCount>16</burstCount> <!-- Increased from 4 to 16 -->
        <range>25.9</range>
        <projectileDef>Bullet_ChargeBlasterHeavy</projectileDef>
      </li>
    </comps>
  </HediffDef>

</Defs>

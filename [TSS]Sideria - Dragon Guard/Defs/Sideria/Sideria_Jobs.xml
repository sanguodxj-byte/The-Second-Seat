<?xml version="1.0" encoding="utf-8" ?>
<Defs>
  <!-- ============================================== -->
  <!-- Sideria 技能相关 Job 定义 -->
  <!-- ============================================== -->

  <!-- 灾厄持有 - 持有被抓取的目标 -->
  <JobDef>
    <defName>Sideria_CalamityHold</defName>
    <driverClass>TheSecondSeat.JobDriver_CalamityHold</driverClass>
    <reportString>holding target for calamity throw</reportString>
    <playerInterruptible>true</playerInterruptible>
    <checkOverrideOnDamage>Always</checkOverrideOnDamage>
    <suspendable>false</suspendable>
    <casualInterruptible>false</casualInterruptible>
    <modExtensions>
      <li Class="TheSecondSeat.DefModExtension_GrabJob">
        <grabbedHediffDefName>Sideria_Grabbed</grabbedHediffDefName>
        <holdingHediffDefName>Sideria_CalamityHolding</holdingHediffDefName>
      </li>
    </modExtensions>
  </JobDef>

  <!-- 灾厄投掷 - 投掷被持有的目标 -->
  <JobDef>
    <defName>Sideria_CalamityThrow</defName>
    <driverClass>TheSecondSeat.JobDriver_CalamityThrow</driverClass>
    <reportString>throwing target</reportString>
    <playerInterruptible>true</playerInterruptible>
    <checkOverrideOnDamage>Always</checkOverrideOnDamage>
    <suspendable>false</suspendable>
    <casualInterruptible>false</casualInterruptible>
    <modExtensions>
      <li Class="TheSecondSeat.DefModExtension_GrabJob">
        <grabbedHediffDefName>Sideria_Grabbed</grabbedHediffDefName>
        <holdingHediffDefName>Sideria_CalamityHolding</holdingHediffDefName>
      </li>
    </modExtensions>
  </JobDef>

  <!-- 灾厄抱摔 - 将目标摔向地面 -->
  <JobDef>
    <defName>Sideria_CalamitySlam</defName>
    <driverClass>TheSecondSeat.JobDriver_CalamitySlam</driverClass>
    <reportString>slamming target into the ground</reportString>
    <playerInterruptible>true</playerInterruptible>
    <checkOverrideOnDamage>Always</checkOverrideOnDamage>
    <suspendable>false</suspendable>
    <casualInterruptible>false</casualInterruptible>
    <modExtensions>
      <li Class="TheSecondSeat.DefModExtension_GrabJob">
        <grabbedHediffDefName>Sideria_Grabbed</grabbedHediffDefName>
        <holdingHediffDefName>Sideria_CalamityHolding</holdingHediffDefName>
      </li>
    </modExtensions>
  </JobDef>

  <!-- ============================================== -->
  <!-- 灾厄摔掷相关 Hediff -->
  <!-- ============================================== -->

  <!-- 被抓取状态（应用于目标） -->
  <HediffDef>
    <defName>Sideria_Grabbed</defName>
    <label>grabbed</label>
    <description>This creature has been grabbed by Sideria and cannot move until released, thrown, or slammed.</description>
    <hediffClass>Hediff</hediffClass>
    <isBad>true</isBad>
    <tendable>false</tendable>
    <makesSickThought>false</makesSickThought>
    <makesAlert>false</makesAlert>
    <stages>
      <li>
        <label>restrained</label>
        <capMods>
          <li>
            <capacity>Moving</capacity>
            <setMax>0</setMax>
          </li>
          <li>
            <capacity>Manipulation</capacity>
            <setMax>0</setMax>
          </li>
        </capMods>
      </li>
    </stages>
  </HediffDef>

  <!-- 灾厄持有状态（应用于施法者，提供投掷/抱摔 Gizmo） -->
  <HediffDef>
    <defName>Sideria_CalamityHolding</defName>
    <label>holding target</label>
    <description>Sideria is holding a creature, ready to throw or slam it.</description>
    <hediffClass>TheSecondSeat.Hediff_CalamityHolding</hediffClass>
    <isBad>false</isBad>
    <tendable>false</tendable>
    <makesSickThought>false</makesSickThought>
    <makesAlert>false</makesAlert>
    <comps>
      <li Class="TheSecondSeat.HediffCompProperties_CalamityHoldActions">
        <throwJobDefName>Sideria_CalamityThrow</throwJobDefName>
        <slamJobDefName>Sideria_CalamitySlam</slamJobDefName>
      </li>
    </comps>
    <stages>
      <li>
        <label>holding</label>
      </li>
    </stages>
  </HediffDef>

  <!-- 灾厄投掷伤害加成（用于传递伤害倍率） -->
  <HediffDef>
    <defName>Sideria_CalamityThrowBonus</defName>
    <label>calamity throw power</label>
    <description>Enhanced throwing power from Sideria's calamity throw ability.</description>
    <hediffClass>Hediff</hediffClass>
    <isBad>false</isBad>
    <tendable>false</tendable>
    <makesSickThought>false</makesSickThought>
    <makesAlert>false</makesAlert>
    <initialSeverity>2.0</initialSeverity>
    <stages>
      <li>
        <label>enhanced</label>
      </li>
    </stages>
  </HediffDef>

  <!-- ============================================== -->
  <!-- 飞行器定义 -->
  <!-- ============================================== -->
  <ThingDef>
    <defName>Sideria_PawnFlyer_Calamity</defName>
    <label>Calamity Thrown Object</label>
    <thingClass>TheSecondSeat.PawnFlyer_CalamityThrow</thingClass>
    <category>Mote</category>
    <tickerType>Normal</tickerType>
    <altitudeLayer>MoteOverhead</altitudeLayer>
    <useHitPoints>False</useHitPoints>
    <isSaveable>true</isSaveable>
    <drawOffscreen>true</drawOffscreen>
    <!-- PawnFlyer 必需的配置 - 缺少此配置会导致 Tick() 时 NullReferenceException -->
    <pawnFlyer>
      <flightSpeed>15</flightSpeed>
      <flightDurationMin>0.3</flightDurationMin>
      <heightFactor>1.5</heightFactor>
    </pawnFlyer>
  </ThingDef>

</Defs>